# Git Branch Cleaner - TUIツール要件定義書

## 1. プロジェクト概要

### 目的

Gitのローカルブランチを効率的に削除するためのTUI（Terminal User Interface）ツールを開発する。

### 背景

- ローカルに蓄積されたブランチの整理作業を効率化したい
- 複数ブランチの一括削除を安全に実行したい
- マージ状況を確認しながら削除対象を選択したい

## 2. 機能要件

### 2.1 基本機能

#### ブランチ一覧表示

- ローカルブランチの一覧を表形式で表示
- 以下の情報を各ブランチに対して表示：
  - ブランチ名
  - マージ状況（マージ済み/未マージ）
  - 最終コミット日時
  - 最終コミットメッセージ
  - コミット数（mainからの差分）
  - 作成者情報

#### ブランチ選択機能

- チェックボックス形式での複数選択
- 個別選択・全選択・全解除の操作
- キーボード操作（矢印キー、スペースキー、Enter）とマウス操作の両方に対応

#### 削除実行機能

- 選択されたブランチの一括削除
- 削除完了後のブランチ選択機能へ遷移

### 2.2 安全機能

#### 保護ブランチ

- mainブランチは削除対象から除外（選択不可状態で表示）

#### 確認機能

- 削除対象ブランチ一覧の確認ダイアログ表示
- 未マージブランチが選択されている場合の警告表示
- 削除実行前の最終確認（y/n）

### 2.3 エラーハンドリング

#### エラー検出と表示

以下の状況でエラーメッセージを表示し、適切に処理終了：

- Gitリポジトリではないディレクトリで実行された場合
- ローカルブランチが存在しない場合
- Git操作でエラーが発生した場合（権限不足、ファイルロックなど）

## 3. 非機能要件

### 3.1 技術要件

#### 開発言語・ライブラリ

- **言語**: Go
- **TUIライブラリ**: Charm Bracelet製ライブラリ群を使用
  - github.com/charmbracelet/bubbletea（メインフレームワーク）
  - github.com/charmbracelet/lipgloss（スタイリング）
  - github.com/charmbracelet/bubbles（UIコンポーネント）

#### 対象OS

- Linux
- macOS  
- Windows

### 3.2 パフォーマンス要件

- ブランチ一覧の表示は1秒以内
- ブランチ削除処理は対話的に実行（進捗表示は不要）

### 3.3 ユーザビリティ要件

- キーボードのみでの操作が可能
- マウス操作にも対応
- 直感的なUI設計（チェックボックス、確認ダイアログ）

## 4. 画面設計概要

### 4.1 メイン画面

```shell
┌─ Git Branch Cleaner ─────────────────────────────────────┐
│ Repository: /path/to/repo                                │
├──────────────────────────────────────────────────────────┤
│ [ ] feature/login-form    │ Unmerged │ 2024-06-15 │ 3↑   │
│ [x] feature/bug-fix       │ Merged   │ 2024-06-10 │ 0↑   │
│ [ ] hotfix/critical-issue │ Unmerged │ 2024-06-14 │ 1↑   │
│ [-] main                  │ -        │ 2024-06-16 │ -    │
├──────────────────────────────────────────────────────────┤
│ [Delete Selected] [Cancel]                               │
└──────────────────────────────────────────────────────────┘
```

### 4.2 確認ダイアログ

```shell
┌─ Confirm Deletion ──────────────────────────────────────┐
│ The following branches will be deleted:                 │
│                                                         │
│ • feature/bug-fix (Merged)                             │
│                                                         │
│ Continue? (y/N)                                        │
└─────────────────────────────────────────────────────────┘
```

## 5. 開発制約・前提条件

### 5.1 前提条件

- 実行環境にGitがインストールされていること
- 対象ディレクトリがGitリポジトリであること

### 5.2 制約事項

- 現在のディレクトリのGitリポジトリのみを対象とする
- リモートブランチは対象外
- 設定ファイルによるカスタマイズは対応しない（初期版）

## 6. 今後の拡張可能性

以下の機能は初期版では実装せず、将来的な拡張として検討：

- フィルタ機能（ブランチ名検索、マージ状況絞り込み）
- 保護ブランチの設定機能
- 設定ファイルでの永続化
- 他ディレクトリのリポジトリ指定機能
- 表示カラムのカスタマイズ

## 7. 成果物

- 実行可能なバイナリファイル（各OS対応）
- README.md（使用方法、インストール手順）
- ソースコード一式
